# 03 テストと運用

実行時テスト項目と、改善・運用のメモです。

---

## 1. 実行時テスト項目（要約）

ローカル起動後（フロント: http://localhost:5200、バックエンド: http://localhost:8002）に実施します。

| 分類 | 主な確認内容 |
|------|--------------|
| **認証** | 未ログインで保護ルート → /login へ。ログイン成功 → /menu。新規登録 → 遷移。ログアウト → /login。 |
| **ルーティング** | / → /menu。「予約する」→ /calendar。「予約を確認する」→ /reservations。 |
| **カレンダー** | 月表示・前月/次月・過去日選択不可・今日以降で /reserve/form へ遷移。 |
| **予約フォーム** | 日付なし時は「日付が選択されていません」。大分類・診療科・目的・担当医・時間を選び「確認画面へ」→ /reserve/confirm。 |
| **予約確認・確定** | 内容表示・「予約を確定する」で Firestore に保存・完了表示。「修正する」でフォームに戻る。 |
| **予約一覧** | 一覧表示・変更（編集→確定）・キャンセル（確認ダイアログ→削除）。 |
| **重複・エラー** | 同一ユーザー同一日時は弾かれる。担当医重複（他ユーザー）時はメッセージ表示。通信エラー時は一般メッセージのみ（技術詳細は非表示）。 |

### 簡易チェックリスト

- [ ] 未ログイン → ログインへ
- [ ] ログイン成功 → メニュー
- [ ] 新規登録 → 遷移
- [ ] ログアウト
- [ ] 予約する → カレンダー
- [ ] カレンダー表示・日付選択 → フォーム
- [ ] フォーム入力・確認画面へ
- [ ] 予約確定
- [ ] 一覧表示・キャンセル
- [ ] 同一日時重複で弾かれる

---

## 2. レビュー結果（サマリ）

- 要件定義・必須機能・画面遷移・Auth/Firestore の分離はプロンプトの意図を満たしている。
- 関数名・フォーム項目は Day5 要件定義書に合わせた正当な差分。発表可能な品質。

---

## 3. 改善・運用メモ

| 項目 | 内容 |
|------|------|
| **UX** | フォーム送信中のローディング表示、予約0件時の「予約する」リンク、新規登録後の遷移先（/calendar のまま or /menu に統一） |
| **運用** | .env は .gitignore 済み。本番では環境変数で設定を注入。CORS は本番 URL に変更。 |
| **Firestore** | 担当医指定時の重複チェックで複合インデックス（date, time, department, doctor）が必要。未デプロイ時は「一時的にエラーが発生しました」と表示される。 |
| **拡張（任意）** | 医師マスタの Firestore 連携、予約枠のマスタ管理、E2E テスト（Playwright 等） |
